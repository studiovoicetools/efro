diff --git a/src/lib/shopify/verifyOauthHmac.ts b/src/lib/shopify/verifyOauthHmac.ts
new file mode 100644
index 0000000..02b906b
--- /dev/null
+++ b/src/lib/shopify/verifyOauthHmac.ts
@@ -0,0 +1,38 @@
+// src/lib/shopify/verifyOauthHmac.ts
+// Verifiziert HMAC für Shopify OAuth-Callback Query-Parameter.
+// Wichtig: Das ist NICHT der Webhook-HMAC (x-shopify-hmac-sha256), sondern Query-HMAC.
+//
+// Shopify-Doku: OAuth callback includes "hmac" and query params.
+// Signatur: HMAC-SHA256 über sorted query string (ohne hmac, ohne signature).
+
+import crypto from "crypto";
+
+export function verifyShopifyOauthHmac(
+  searchParams: URLSearchParams,
+  secret: string
+): { ok: boolean; reason?: string } {
+  const hmac = (searchParams.get("hmac") || "").trim();
+  if (!hmac) return { ok: false, reason: "missing_hmac" };
+  if (!secret) return { ok: false, reason: "missing_secret" };
+
+  // Shopify: exclude hmac + signature
+  const pairs: string[] = [];
+  for (const [k, v] of searchParams.entries()) {
+    if (k === "hmac" || k === "signature") continue;
+    pairs.push(`${k}=${v}`);
+  }
+
+  // sort lexicographically by key=value string is fine because key is first
+  pairs.sort();
+
+  const message = pairs.join("&");
+  const digest = crypto.createHmac("sha256", secret).update(message).digest("hex");
+
+  // timing safe compare
+  const a = Buffer.from(digest, "utf8");
+  const b = Buffer.from(hmac, "utf8");
+  if (a.length !== b.length) return { ok: false, reason: "hmac_length_mismatch" };
+
+  const ok = crypto.timingSafeEqual(a, b);
+  return ok ? { ok: true } : { ok: false, reason: "hmac_mismatch" };
+}
